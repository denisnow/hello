<!doctype html>

<html lang="en">

	<head>
	
		<meta charset="utf-8">

		<style>
			@import url("https://fonts.googleapis.com/css?family=Roboto+Mono&display=swap");
			.reactMain {
				font-family: "Roboto Mono", monospace;
				font-size: 15vw;
			}
		</style>

	</head>

	<body>

		<div class="reactMain"></div>

		<script type="text/babel">
		
		// ------------------------ Main ----------------------------

		function Main() {

			return <div><TextSmart textToDisplay="hello" /><CursorSmart /></div>;

		}

		// ------------------------ Text ----------------------------

		class TextSmart extends React.Component {

			state = {displayed: ""};
			
			displayChar(charToDisplay, delayLength) {
				setTimeout(() => this.setState({displayed: this.state.displayed + charToDisplay}), delayLength);
			}

			displayFirstChar() {
				this.displayChar(this.props.textToDisplay[0], 333+Math.random()*777);
			}

			displayNextChar() {
				let isFullTextDisplayed = this.state.displayed.length === this.props.textToDisplay.length;

				if (!isFullTextDisplayed) {
					let charToDisplay = this.props.textToDisplay[this.state.displayed.length];		
					let previousChar = this.props.textToDisplay[this.state.displayed.length-1];
					
					let delayLength = (charToDisplay === previousChar) ? 150 : 333+Math.random()*777;

					this.displayChar (charToDisplay, delayLength);
				}
			}

			componentDidMount() {
				this.displayFirstChar();
			}
			
			componentDidUpdate() {
				this.displayNextChar();
			}

			render() {
				return <span>{this.state.displayedText}</span>;
			}
		}
		
		// ------------------------ Cursor --------------------------

		class CursorSmart extends React.Component {

			state = {cursor: "_"};

			toggleCursorState() {
				let newState = (this.state.cursor) ? {cursor: ""} : {cursor: "_"};
					
				setTimeout(() => this.setState(newState), 555);
			}

			componentDidMount() {
				this.toggleCursorState();
			}
			
			componentDidUpdate() {
				this.toggleCursorState();
			}

			render() {
				return <span>{this.state.cursor}</span>;
			}
		}
		
		// ----------------------------------------------------------

		ReactDOM.render(<Main />, document.body.querySelector(".reactMain"));

		</script>

		<script src="https://unpkg.com/babel-standalone@6.26.0/babel.min.js"></script>
		<script src="https://unpkg.com/react@16.7.0/umd/react.production.min.js" crossorigin></script>
		<script src="https://unpkg.com/react-dom@16.7.0/umd/react-dom.production.min.js" crossorigin></script>

	</body>

</html>