<!doctype html>

<html lang="en">

	<head>
	
		<meta charset="utf-8">
		<link href="https://fonts.googleapis.com/css?family=Roboto+Mono&display=swap" rel="stylesheet">

		<style>
			.reactMainComponent {
				font-family: "Roboto Mono", monospace;
				font-size: 15vw;
			}
		</style>

	</head>

	<body>

		<div class="reactMainComponent"></div>

		<script type="text/babel">
		
		// ------------------------ App class ------------------------------------

		class App extends React.Component {

			render() {
				return <div><TextSmart textToDisplay="hello" /><CursorSmart /></div>;
			}
		}

		// ------------------------ Text smart class -----------------------------

		class TextSmart extends React.Component {

			constructor() {
				super();
				this.state = { displayedText: "" };	
			}

			addCharToDisplayedText(charToAdd) {
				this.setState( { displayedText: this.state.displayedText + charToAdd } );
			}

			displayFirstChar() {
				if (this.props.textToDisplay) 
					setTimeout(() => this.setState( { displayedText: this.props.textToDisplay[0] } ), 555);
			}

			displayNextChar() {
				let charToDisplay = this.props.textToDisplay[this.state.displayedText.length];		
				let previousChar = this.props.textToDisplay[this.state.displayedText.length-1];
				
				let delay = (charToDisplay === previousChar) ? 150 : 333 + Math.random() * 777;
				
				setTimeout(() => this.addCharToDisplayedText(charToDisplay), delay);
			}

			componentDidMount() {
				this.displayFirstChar();
			}
			
			componentDidUpdate() {
				let isFullTextDisplayed = this.state.displayedText.length === this.props.textToDisplay.length;
			
				if (!isFullTextDisplayed) this.displayNextChar();
			}

			render() {
				return <span>{this.state.displayedText}</span>;
			}
		}

		// ------------------------ Cursor smart class ---------------------------

		class CursorSmart extends React.Component {

			constructor() {
				super();
				this.state = { cursor: "_" };
			}

			toggleCursorState() {
				let newState = (this.state.cursor) ? { cursor: "" } : { cursor: "_" };
					
				setTimeout(() => this.setState(newState), 555);
			}

			componentDidMount() {
				this.toggleCursorState();
			}
			
			componentDidUpdate() {
				this.toggleCursorState();
			}

			render() {
				return <span>{this.state.cursor}</span>;
			}
		}

		// -----------------------------------------------------------------------

		ReactDOM.render(<App />, document.body.querySelector(".reactMainComponent"));

		</script>

		<script src="https://unpkg.com/babel-standalone@6.26.0/babel.min.js"></script>
		<script src="https://unpkg.com/react@16.7.0/umd/react.production.min.js" crossorigin></script>
		<script src="https://unpkg.com/react-dom@16.7.0/umd/react-dom.production.min.js" crossorigin></script>

	</body>

</html>